@startuml
title Процесс "Планирование и управление этапами"

start

partition "Руководитель / Бригадир" {
  :Открыть заявку\n(со статусом "Новая" или "В работе");
  :Перейти к планированию этапов;
  if (Использовать шаблон\nтиповых этапов?) then (Да)
    :Выбрать шаблон этапов;
  else (Нет)
    :Решить декомпозицию\n"с нуля";
  endif
}

partition "Система" {
  if (Выбран шаблон этапов?) then (Да)
    :Создать этапы заявки\nна основании шаблона;
  else (Нет)
    :Подготовить пустой\nсписок этапов;
  endif
}

' Цикл по этапам (создание/редактирование)
while (Добавить/изменить\nэтап?) is (Да)
  partition "Руководитель / Бригадир" {
    if (Создать новый этап?) then (Да)
      :Создать этап;
    else (Нет)
      :Выбрать существующий этап\nдля редактирования;
    endif

    :Указать наименование этапа;
    :Указать описание этапа;
    :Указать плановые даты\nначала/окончания;
    :Определить зависимости\nот других этапов;
    :Сформировать перечень\nнеобходимых ресурсов\n(типы, количество и т.п.);
    :Сохранить этап;
  }
endwhile (Нет)

partition "Руководитель / Бригадир" {
  :Сформировать запрос\nна назначение исполнителей\nпо этапам;
}

partition "Система" {
  :Отправить запрос\nДиректору отдела разработки;
  :Уведомить Директора\nо новом запросе;
}

partition "Директор отдела разработки" {
  :Открыть список запросов\nна назначение исполнителей;
  :Выбрать заявку/этапы\nдля обработки;
  :Проанализировать перечень\nэтапов и требуемые ресурсы;
}

' Цикл назначения исполнителей по этапам
while (Есть этапы без\nисполнителей?) is (Да)
  partition "Директор отдела разработки" {
    :Выбрать этап;
    :Выбрать исполнителя(ей)\nс учетом загрузки и квалификации;
  }
  partition "Система" {
    :Назначить исполнителя(ей)\nна этап;
  }
endwhile (Нет)

partition "Система" {
  :Зафиксировать назначения\nв системе;
  :Уведомить Руководителя и Исполнителей\nо назначенных этапах;
}

stop
@enduml
