@startuml
title Процесс "Управление складом и ресурсами"

start

partition "Работник склада" {
  if (Задача: регистрация\nноменклатуры?) then (Да)
    :Открыть справочник\nтипов ресурсов;
    :Создать/отредактировать\nтип ресурса
    (оборудование,\nрасходники и т.п.);
    :Заполнить атрибуты\n(ед. измерения,\nлимиты, описания);
    partition "Система" {
      :Сохранить номенклатуру\nи типы ресурсов;
    }
  endif
}

partition "Работник склада" {
  if (Задача: учет поступлений?) then (Да)
    :Открыть форму\nприходной накладной;
    :Ввести данные\nпоставки (поставщик,\nдата, позиции, количество);
    partition "Система" {
      :Обновить остатки\nресурсов на складе;
      :Зарегистрировать\nприходную накладную;
    }
  endif
}

' Резервирование и выдача ресурсов по этапам
partition "Система" {
  :Получить запросы\nресурсов по этапам\n(от Руководителя/\nИсполнителя);
}

while (Обработать запрос\nна ресурсы?) is (Да)
  partition "Работник склада" {
    :Открыть запрос на ресурсы;
  }
  partition "Система" {
    :Показать требуемые ресурсы\nи доступные остатки;
  }

  partition "Работник склада" {
    if (Достаточно ресурсов\nна складе?) then (Да)
      :Принять решение\nо резервировании;
      partition "Система" {
        :Резервировать ресурсы\nпод этап;
        :Обновить доступные остатки;
      }
      :Подготовить выдачу ресурсов;
      partition "Система" {
        :Зафиксировать операцию\nвыдачи ресурсов;
      }
      if (Предполагается возврат\n(оборудование и т.п.)?) then (Да)
        :Ожидать возврат\nот исполнителя;
        :Принять возврат ресурсов;
        partition "Система" {
          :Обновить остатки\nи статус резервирования;
        }
      endif
    else (Нет)
      :Сообщить об\nнедостатке ресурсов\nРуководителю/Исполнителю;
    endif
  }
endwhile (Нет)

' Инвентаризация
partition "Работник склада" {
  if (Провести инвентаризацию?) then (Да)
    :Инициировать процедуру\nинвентаризации;
    :Сверить фактические остатки\nс учетными данными;
    partition "Система" {
      :Зафиксировать результаты\nинвентаризации (излишки,\nнедостачи, корректировки);
      :Обновить учетные остатки\nресурсов на складе;
    }
  endif
}

stop
@enduml