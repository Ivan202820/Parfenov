@startuml
title Процесс "Формирование отчетности"

start

partition "Пользователь\n(любая роль)" {
  :Авторизоваться в системе;
}

partition "Система" {
  :Проверить учетные данные;
  :Определить роль пользователя\n(Администратор, Руководитель,\nИсполнитель, Работник склада);
  :Сформировать доступный список\nтипов отчетов в соответствии\nс ролью и правами;
  :Показать доступные отчеты:
  - Статусы заявок
  - Загрузка исполнителей
  - Использование ресурсов
  - Остатки на складе;
}

partition "Пользователь\n(в рамках прав)" {
  :Выбрать тип отчета;
  :Указать параметры отчета\n(период, фильтры,\nподразделения и т.п.);
  :Запросить формирование отчета;
}

partition "Система" {
  :Проверить права пользователя\nна выбранный тип отчета;
  if (Права достаточно?) then (Да)
    :Собрать данные из\nсоответствующих подсистем
    (заявки, этапы,\nресурсы, склад);
    :Сформировать отчет\n(таблица/графики и т.п.);
    :Отобразить отчет\nпользователю;
    if (Выгрузить или\nраспечатать отчет?) then (Да)
      :Предложить форматы\n(Excel, PDF и т.п.);
      :Сформировать файл\nи выдать пользователю;
    endif
  else (Нет)
    :Показать сообщение\n"Недостаточно прав\nдля просмотра отчета";
  endif
}

stop
@enduml